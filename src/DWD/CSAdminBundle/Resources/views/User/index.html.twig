{% extends "DWDCsAdminBundle:Layout:layout.html.twig" %}

{% block body %}
<div class="ch-container">
    <div id="content" class="col-lg-10 col-sm-10">
            <!-- content starts -->
                <div>
        <ul class="breadcrumb">
            <li>
                <a href="/admin">首页</a>
            </li>
            <li>
                用户投诉
            </li>
        </ul>
    </div>
    <div class="row">
        <div class="box col-md-12">
            <div class="box-inner">
                <div class="box-header well">
                    <h2><i class="glyphicon glyphicon-user"></i> {{ 'title.userinfo'|trans }}</h2>
                </div> 
                <div class="box-content">
                    <ul class="dashboard-list">
                        <li> 
                            <img class="dashboard-avatar" src="{{ userinfo['avatar'] }}">
                            <strong>{{ 'label.user_id'|trans }}&nbsp;:&nbsp;</strong> {{ userinfo['id'] }}<br><br>
                            <strong>{{ 'label.username'|trans }}&nbsp;:&nbsp;</strong> {{ userinfo['username'] }}&nbsp;&nbsp;&nbsp;<a href="#">[编辑帐号]</a><br><br>
                            <strong>{{ 'label.email'|trans }}&nbsp;:&nbsp;</strong> {{ userinfo['email'] }}<br><br>
                            <strong>{{ 'label.locked'|trans }}&nbsp;:&nbsp;</strong> <span class="label-success label label-default">可用</span>&nbsp;&nbsp;&nbsp; <span class="label-success label label-default">未封号</span>&nbsp;&nbsp;&nbsp;<a href="#">[封号]</a>&nbsp;&nbsp;&nbsp;<a id='lockedrecords-btn' href="#">[封号记录]</a><br><br> 
                            <strong>{{ 'label.mobile'|trans }}&nbsp;:&nbsp;</strong> {{ userinfo['mobile'] }}&nbsp;&nbsp;&nbsp;<a href="#">[解绑设备]</a>&nbsp;&nbsp;&nbsp;<br><br>
                            <strong>{{ 'label.balance'|trans }}&nbsp;:&nbsp;</strong> {{ userinfo['balance'] }}元&nbsp;&nbsp;&nbsp;<a id='balancerecords-btn' href="#">[余额记录]</a><br><br>
                            <strong>{{ 'label.coin'|trans }}&nbsp;:&nbsp;</strong> {{ userinfo['coin'] }}&nbsp;&nbsp;&nbsp;<a id='coinrecords-btn' href="#">[金币记录]</a>&nbsp;&nbsp;&nbsp;<a id='recommendrecords-btn' href="#">[推荐好友记录]</a><br><br>
                            <strong>{{ 'label.last_login'|trans }}&nbsp;:&nbsp;</strong> {{ userinfo['last_login'] }}<br><br>
                            <strong>{{ 'label.created_at'|trans }}&nbsp;:&nbsp;</strong> {{ userinfo['created_at'] }}&nbsp;&nbsp;&nbsp;<a id='smsrecords-btn' href="#">[短信记录]</a><br><br>
                        </li>
                    <ul>
                </div>
            </div>
        </div>
    </div> 
 
    <div class="row">
        <div class="box col-md-12">
            <div class="box-inner">
                <div class="box-header well" data-original-title="">
                    <h2>{{ 'title.order_list'|trans }}</h2>

                    <div class="box-icon"> 
                        <a href="#" class="btn btn-minimize btn-round btn-default"><i
                                class="glyphicon glyphicon-chevron-up"></i></a> 
                    </div>
                </div>
                <div class="box-content">
                    <br />
                    <ul class="nav nav-tabs" id="orderListTab">
                        {% for type, typeLabel in orderlistTypes %}
                            <li><a href="#{{type}}">{{typeLabel}}</a></li>
                        {% endfor %}
                    </ul><br />
                    <div id="orderListTabContent" class="tab-content">
                    {% for type, typeLabel in orderlistTypes %}
                        <div class="tab-pane active" id="{{type}}">
                            <table id="{{ type }}-orderlist-table" class="table table-striped table-bordered bootstrap-datatable responsive">
                            <thead>
                            <tr>
                                <th>{{ 'label.order_id'|trans }}</th>
                                <th>{{ 'label.campaign_branch_id'|trans }}</th>
                                <th>{{ 'label.user_id'|trans }}</th>
                                <th>{{ 'label.price'|trans }}</th>
                                <th>{{ 'label.status'|trans }}</th>
                                <th>{{ 'label.type'|trans }}</th>
                                <th>{{ 'label.trade_number'|trans }}</th>
                                <th>{{ 'label.created_at'|trans }}</th> 
                                <th>{{ 'label.updated_at'|trans }}</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                            </table>
                        </div>
                    {% endfor %} 
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="box col-md-12">
            <div class="box-inner">
                <div class="box-header well" data-original-title="">
                    <h2>{{ 'title.complaintrecords_list'|trans }}</h2>

                    <div class="box-icon"> 
                        <a href="#" class="btn btn-minimize btn-round btn-default"><i
                                class="glyphicon glyphicon-chevron-up"></i></a> 
                    </div>
                </div>
                <div class="box-content"> 
                    <table id="complaintrecords-table" class="table table-striped table-bordered bootstrap-datatable responsive">
                    <thead>
                    <tr>
                        <th>{{ 'label.item_id'|trans }}</th>
                        <th>{{ 'label.order_id'|trans }}</th>
                        <th>{{ 'label.user_id'|trans }}</th>
                        <th>{{ 'label.saler_id'|trans }}</th>
                        <th>{{ 'label.type_id'|trans }}</th>
                        <th>{{ 'label.status'|trans }}</th>
                        <th>{{ 'label.description'|trans }}</th>
                        <th>{{ 'label.from_id'|trans }}</th> 
                        <th>{{ 'label.category_id'|trans }}</th>
                        <th>{{ 'label.mobile'|trans }}</th> 
                        <th>{{ 'label.created_at'|trans }}</th>
                        <th>{{ 'label.updated_at'|trans }}</th> 
                        <th>{{ 'label.resolved_at'|trans }}</th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                    </table>
            </div>
        </div>
    </div>

    <div class="modal fade" id="coinRecordsModal" tabindex="-1" role="dialog" aria-labelledby="coinRecordsModal"
         aria-hidden="true">

        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h3>{{ 'title.coin_record_list'|trans }}</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-striped table-bordered bootstrap-datatable responsive" id="coinrecords-table">
                    <thead>
                    <tr>
                        <th>{{ 'label.name'|trans }}</th>
                        <th>{{ 'label.record_type'|trans }}</th>
                        <th>{{ 'label.coin_amount'|trans }}</th>
                        <th>{{ 'label.current_coin'|trans }}</th>
                        <th>{{ 'label.created_at'|trans }}</th>
                    </tr>
                    </thead>
                    <tbody>  
                    </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="#" class="btn btn-default" data-dismiss="modal">关闭</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="balanceRecordsModal" tabindex="-1" role="dialog" aria-labelledby="balanceRecordsModal"
         aria-hidden="true">

        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h3>{{ 'title.balance_record_list'|trans }}</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-striped table-bordered bootstrap-datatable responsive" id="balancerecords-table">
                    <thead>
                    <tr>
                        <th>{{ 'label.name'|trans }}</th>
                        <th>{{ 'label.record_type'|trans }}</th>
                        <th>{{ 'label.balance_amount'|trans }}</th>
                        <th>{{ 'label.current_balance'|trans }}</th>
                        <th>{{ 'label.created_at'|trans }}</th> 
                    </tr>
                    </thead>
                    <tbody>  
                    </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="#" class="btn btn-default" data-dismiss="modal">关闭</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="lockedRecordsModal" tabindex="-1" role="dialog" aria-labelledby="lockedRecordsModal"
         aria-hidden="true">

        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h3>{{ 'title.locked_record_list'|trans }}</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-striped table-bordered bootstrap-datatable responsive" id="lockedrecords-table">
                    <thead>
                    <tr>
                        <th>{{ 'label.user_id'|trans }}</th>
                        <th>{{ 'label.operator_user_id'|trans }}</th>
                        <th>{{ 'label.type'|trans }}</th>
                        <th>{{ 'label.lock_date'|trans }}</th>
                        <th>{{ 'label.note'|trans }}</th> 
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="#" class="btn btn-default" data-dismiss="modal">关闭</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="recommendRecordsModal" tabindex="-1" role="dialog" aria-labelledby="recommendRecordsModal"
         aria-hidden="true">

        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h3>{{ 'title.recommend_record_list'|trans }}</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-striped table-bordered bootstrap-datatable responsive" id="recommendrecords-table">
                    <thead>
                    <tr>
                        <th>{{ 'label.user_id'|trans }}</th>
                        <th>{{ 'label.recommend_user_id'|trans }}</th>
                        <th>{{ 'label.created_at'|trans }}</th> 
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="#" class="btn btn-default" data-dismiss="modal">关闭</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="smsRecordsModal" tabindex="-1" role="dialog" aria-labelledby="smsRecordsModal"
         aria-hidden="true">

        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h3>{{ 'title.sms_record_list'|trans }}</h3>
                </div>
                <div class="modal-body">
                    <table class="table table-striped table-bordered bootstrap-datatable responsive" id="smsrecords-table">
                    <thead>
                    <tr>
                        <th>{{ 'label.content'|trans }}</th>
                        <th>{{ 'label.type'|trans }}</th>
                        <th>{{ 'label.mobile'|trans }}</th> 
                        <th>{{ 'label.create_at'|trans }}</th> 
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <a href="#" class="btn btn-default" data-dismiss="modal">关闭</a>
                </div>
            </div>
        </div>
    </div>

</div>
<script type="text/javascript" >
    $(document).ready(function() {
        {% for type, typeLabel in orderlistTypes %}
            $('#{{type}}-orderlist-table').dataTable({
                "bProcessing": true,
                "bStateSave": true,
                "bServerSide":  true,
                "sAjaxSource": "user/orderlist?userId={{userId}}&type={{type}}",
                "sDom": "<'row'<'col-md-6'l><'col-md-6'f>r>t<'row'<'col-md-12'i><'col-md-12 center-block'p>>",
                "sPaginationType": "bootstrap",
                "oLanguage": { //国际化配置  
                    "sProcessing" : "正在获取数据，请稍后...",    
                    "sLengthMenu" : "显示 _MENU_ 条",    
                    "sZeroRecords" : "没有您要搜索的内容",    
                    "sInfo" : "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",    
                    "sInfoEmpty" : "记录数为0",    
                    "sInfoFiltered" : "(全部记录数 _MAX_ 条)",    
                    "sInfoPostFix" : "",    
                    "sSearch" : "搜索订单",    
                    "sUrl" : "", 
                    "oPaginate": {    
                        "sFirst" : "第一页",    
                        "sPrevious" : "上一页",    
                        "sNext" : "下一页",    
                        "sLast" : "最后一页"    
                    }
                },
                "aoColumns": [
                        {"mData": 'order_id'},
                        {"mData": 'campaign_branch_id'},
                        {"mData": 'user_id'},
                        {"mData": 'price'},
                        {"mData": 'status'},
                        {"mData": 'type'},
                        {"mData": 'trade_number'},
                        {"mData": 'created_at'},
                        {"mData": 'updated_at'},
                    ],
                "aoColumnDefs": [
                        {"bSortable": false, "aTargets": [1, 2, 3, 4, 5, 7]},
                    ],
            });
        {% endfor %}

        $('#complaintrecords-table').dataTable({
                "bProcessing": true,
                "bStateSave": true,
                "bFilter": false,
                "bServerSide":  true,
                "sAjaxSource": "user/complaintrecords?userId={{userId}}",
                "sDom": "<'row'<'col-md-6'l><'col-md-6'f>r>t<'row'<'col-md-12'i><'col-md-12 center-block'p>>",
                "sPaginationType": "bootstrap",
                "oLanguage": { //国际化配置  
                    "sProcessing" : "正在获取数据，请稍后...",    
                    "sLengthMenu" : "显示 _MENU_ 条",    
                    "sZeroRecords" : "没有您要搜索的内容",    
                    "sInfo" : "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",    
                    "sInfoEmpty" : "记录数为0",    
                    "sInfoFiltered" : "(全部记录数 _MAX_ 条)",    
                    "sInfoPostFix" : "",    
                    "sSearch" : "搜索",    
                    "sUrl" : "", 
                    "oPaginate": {    
                        "sFirst" : "第一页",    
                        "sPrevious" : "上一页",    
                        "sNext" : "下一页",    
                        "sLast" : "最后一页"    
                    }
                },
                "aoColumns": [
                        {"mData": 'item_id'},
                        {"mData": 'order_id'},
                        {"mData": 'user_id'},
                        {"mData": 'saler_id'},
                        {"mData": 'type_id'}, 
                        {"mData": 'status'},
                        {"mData": 'description'},
                        {"mData": 'from_id'},
                        {"mData": 'category_id'},
                        {"mData": 'mobile'}, 
                        {"mData": 'created_at'}, 
                        {"mData": 'updated_at'}, 
                        {"mData": 'resolved_at'}, 
                    ],
                "aoColumnDefs": [
                        {"bSortable": false, "aTargets": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]},
                    ],
        }); 

        $('#coinrecords-table').dataTable({
                "bProcessing": true,
                "bStateSave": true,
                "bFilter": false, 
                "bServerSide":  true,
                "sAjaxSource": "user/coinrecords?userId={{userId}}",
                "sDom": "<'row'<'col-md-6'l><'col-md-6'f>r>t<'row'<'col-md-12'i><'col-md-12 center-block'p>>",
                "sPaginationType": "bootstrap",
                "oLanguage": { //国际化配置  
                    "sProcessing" : "正在获取数据，请稍后...",    
                    "sLengthMenu" : "显示 _MENU_ 条",    
                    "sZeroRecords" : "没有您要搜索的内容",    
                    "sInfo" : "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",    
                    "sInfoEmpty" : "记录数为0",    
                    "sInfoFiltered" : "(全部记录数 _MAX_ 条)",    
                    "sInfoPostFix" : "",    
                    "sSearch" : "搜索",    
                    "sUrl" : "", 
                    "oPaginate": {    
                        "sFirst" : "第一页",    
                        "sPrevious" : "上一页",    
                        "sNext" : "下一页",    
                        "sLast" : "最后一页"    
                    }
                },
                "aoColumns": [
                        {"mData": 'user_id'},
                        {"mData": 'type'},
                        {"mData": 'amount'},
                        {"mData": 'current_balance'},
                        {"mData": 'created_at'}, 
                    ],
                "aoColumnDefs": [
                        {"bSortable": false, "aTargets": [1, 2, 3, 4]},
                    ],
        });

        $('#balancerecords-table').dataTable({
                "bProcessing": true,
                "bStateSave": true,
                "bFilter": false,
                "bServerSide":  true,
                "sAjaxSource": "user/balancerecords?userId={{userId}}",
                "sDom": "<'row'<'col-md-6'l><'col-md-6'f>r>t<'row'<'col-md-12'i><'col-md-12 center-block'p>>",
                "sPaginationType": "bootstrap",
                "oLanguage": { //国际化配置  
                    "sProcessing" : "正在获取数据，请稍后...",    
                    "sLengthMenu" : "显示 _MENU_ 条",    
                    "sZeroRecords" : "没有您要搜索的内容",    
                    "sInfo" : "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",    
                    "sInfoEmpty" : "记录数为0",    
                    "sInfoFiltered" : "(全部记录数 _MAX_ 条)",    
                    "sInfoPostFix" : "",    
                    "sSearch" : "搜索",    
                    "sUrl" : "", 
                    "oPaginate": {    
                        "sFirst" : "第一页",    
                        "sPrevious" : "上一页",    
                        "sNext" : "下一页",    
                        "sLast" : "最后一页"    
                    }
                },
                "aoColumns": [
                        {"mData": 'user_id'},
                        {"mData": 'type'},
                        {"mData": 'amount'},
                        {"mData": 'current_balance'},
                        {"mData": 'created_at'}, 
                    ],
                "aoColumnDefs": [
                        {"bSortable": false, "aTargets": [1, 2, 3, 4]},
                    ],
        });

        $('#lockedrecords-table').dataTable({
                "bProcessing": true,
                "bStateSave": true,
                "bFilter": false,
                "bServerSide":  true,
                "sAjaxSource": "user/lockedrecords?userId={{userId}}",
                "sDom": "<'row'<'col-md-6'l><'col-md-6'f>r>t<'row'<'col-md-12'i><'col-md-12 center-block'p>>",
                "sPaginationType": "bootstrap",
                "oLanguage": { //国际化配置  
                    "sProcessing" : "正在获取数据，请稍后...",    
                    "sLengthMenu" : "显示 _MENU_ 条",    
                    "sZeroRecords" : "没有您要搜索的内容",    
                    "sInfo" : "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",    
                    "sInfoEmpty" : "记录数为0",    
                    "sInfoFiltered" : "(全部记录数 _MAX_ 条)",    
                    "sInfoPostFix" : "",    
                    "sSearch" : "搜索",    
                    "sUrl" : "", 
                    "oPaginate": {    
                        "sFirst" : "第一页",    
                        "sPrevious" : "上一页",    
                        "sNext" : "下一页",    
                        "sLast" : "最后一页"    
                    }
                },
                "aoColumns": [
                        {"mData": 'user_id'},
                        {"mData": 'operator_user_id'},
                        {"mData": 'type'},
                        {"mData": 'lock_date'},
                        {"mData": 'note'},
                    ],
                "aoColumnDefs": [
                        {"bSortable": false, "aTargets": [1, 2, 3, 4]},
                    ],
        });

        $('#recommendrecords-table').dataTable({
                "bProcessing": true,
                "bStateSave": true,
                "bServerSide":  true,
                "bFilter": false,
                "bSortable": false, 
                "sAjaxSource": "user/recommendrecords?userId={{userId}}",
                "sDom": "<'row'<'col-md-6'l><'col-md-6'f>r>t<'row'<'col-md-12'i><'col-md-12 center-block'p>>",
                "sPaginationType": "bootstrap",
                "oLanguage": { //国际化配置  
                    "sProcessing" : "正在获取数据，请稍后...",    
                    "sLengthMenu" : "显示 _MENU_ 条",    
                    "sZeroRecords" : "没有您要搜索的内容",    
                    "sInfo" : "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",    
                    "sInfoEmpty" : "记录数为0",    
                    "sInfoFiltered" : "(全部记录数 _MAX_ 条)",    
                    "sInfoPostFix" : "",    
                    "sSearch" : "搜索",    
                    "sUrl" : "", 
                    "oPaginate": {    
                        "sFirst" : "第一页",    
                        "sPrevious" : "上一页",    
                        "sNext" : "下一页",    
                        "sLast" : "最后一页"    
                    }
                },
                "aoColumns": [
                        {"mData": 'user_id'},
                        {"mData": 'recommend_user_id'}, 
                        {"mData": 'created_at'}, 
                    ], 
        });

        $('#smsrecords-table').dataTable({
                "bProcessing": true,
                "bStateSave": true,
                "bServerSide":  true,
                "bFilter": false,
                "bSortable": false, 
                "sAjaxSource": "user/smsrecords?userId={{userId}}",
                "sDom": "<'row'<'col-md-6'l><'col-md-6'f>r>t<'row'<'col-md-12'i><'col-md-12 center-block'p>>",
                "sPaginationType": "bootstrap",
                "oLanguage": { //国际化配置  
                    "sProcessing" : "正在获取数据，请稍后...",    
                    "sLengthMenu" : "显示 _MENU_ 条",    
                    "sZeroRecords" : "没有您要搜索的内容",    
                    "sInfo" : "从 _START_ 到  _END_ 条记录 总记录数为 _TOTAL_ 条",    
                    "sInfoEmpty" : "记录数为0",    
                    "sInfoFiltered" : "(全部记录数 _MAX_ 条)",    
                    "sInfoPostFix" : "",    
                    "sSearch" : "搜索",    
                    "sUrl" : "", 
                    "oPaginate": {    
                        "sFirst" : "第一页",    
                        "sPrevious" : "上一页",    
                        "sNext" : "下一页",    
                        "sLast" : "最后一页"    
                    }
                },
                "aoColumns": [
                        {"mData": 'content'},
                        {"mData": 'type'}, 
                        {"mData": 'mobile'}, 
                        {"mData": 'create_at'}, 
                    ], 
        });

        $('#orderListTab a:first').tab('show');
        $('#orderListTab a').click(function (e) {
            e.preventDefault();
            $(this).tab('show');
        });

        $('#coinrecords-btn').click(function (e) {
            e.preventDefault();
            $('#coinRecordsModal').modal('show');
        });

        $('#balancerecords-btn').click(function (e) {
            e.preventDefault();
            $('#balanceRecordsModal').modal('show');
        });

        $('#lockedrecords-btn').click(function (e) {
            e.preventDefault();
            $('#lockedRecordsModal').modal('show');
        });

        $('#recommendrecords-btn').click(function (e) {
            e.preventDefault();
            $('#recommendRecordsModal').modal('show');
        });

        $('#smsrecords-btn').click(function (e) {
            e.preventDefault();
            $('#smsRecordsModal').modal('show');
        });
    });
 </script>
{% endblock %}